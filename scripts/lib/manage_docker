: "${ROOT_DIR:?Environment variable ROOT_DIR is not set}"

COMPOSE_FILE="${ROOT_DIR}/docker/docker-compose.yaml"


is_docker_running() {
    local service="${1:-db}"
    local is_running
    is_running=$(docker compose -f "${COMPOSE_FILE}" ps --all --quiet "${service}" | wc -l)
    if [[ ${is_running} -eq 0 ]]; then
        # 1 means not running
        return 1
    fi
    # 0 means running
    return 0
}

start_docker() {
    if ! is_docker_running; then
        echo "Starting docker compose"
        docker compose -f "${COMPOSE_FILE}" up --detach --build
        sleep 2
    fi
}

stop_docker() {
    echo "Stopping docker compose"
    docker compose -f "${COMPOSE_FILE}" down -v
}
