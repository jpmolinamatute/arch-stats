: "${ROOT_DIR:?Environment variable ROOT_DIR is not set}"

COMPOSE_FILE="${ROOT_DIR}/docker/docker-compose.yaml"
WAIT_TIME=2

is_docker_running() {
    [ -n "$(docker compose -f "${COMPOSE_FILE}" ps --all --filter status=running --quiet)" ]
}

start_docker() {
    if is_docker_running; then
        echo "Docker was already running. Nothing to do here"
    else
        echo "Starting docker compose"
        docker compose -f "${COMPOSE_FILE}" up --detach --build
        sleep "${WAIT_TIME}"
    fi
}

stop_docker() {
    echo "Stopping docker compose"
    docker compose -f "${COMPOSE_FILE}" down
    if is_docker_running; then
        echo "Failed to stop docker compose" >&2
    else
        echo "Docker compose stopped successfully"
    fi
}
